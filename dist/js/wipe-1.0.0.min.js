/*!wipe-hyl 1.0.0 发布日期:2018-11-14*/
var moveX,moveY,cas=document.getElementById("cas"),context=cas.getContext("2d"),_w=cas.width,_h=cas.height,radius=30,device=/android|webos|iPhone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());function drawRect(e){e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.globalCompositeOperation="destination-out"}function drawnew(e,t,n,o,c){if(e.save(),e.beginPath(),3===arguments.length)e.arc(t,n,radius,0,2*Math.PI),e.fillStyle="rgb(255,0,0)",e.fill();else{if(5!==arguments.length)return!1;e.lineCap="round",e.moveTo(t,n),e.lineTo(o,c),e.lineWidth=2*radius}e.stroke(),e.restore()}console.log(device),Eventup=device?(Eventdown="touchstart",Eventmove="touchmove","touchend"):(Eventdown="mousedown",Eventmove="mousemove","mouseup");var xx=!1;function clearRect(e){50<getTransparencyPercent(e)&&e.clearRect(0,0,_w,_h)}function getTransparencyPercent(e){for(var t=e.getImageData(0,0,_w,_h),n=0,o=0;o<_h;o++)for(var c=0;c<_w;c++){var i=4*(_w*o+c)+3;0===t.data[i]&&n++}var a=n/(_w*_h)*100;return console.log("透明点的个数"+n),console.log("占总面积"+Math.ceil(a)+"%"),Math.round(a)}cas.addEventListener(Eventdown,function(e){var t=e||window.event;moveX=device?t.touches[0].clientX:t.clientX,moveY=device?t.touches[0].clientY:t.clientY,drawnew(context,moveX,moveY),xx=!0},!1),cas.addEventListener(Eventmove,function(e){if(!xx)return!1;var t=e||window.event;t.preventDefault();var n=device?t.touches[0].clientX:t.clientX,o=device?t.touches[0].clientY:t.clientY;drawnew(context,moveX,moveY,n,o),moveX=n,moveY=o},!1),cas.addEventListener(Eventup,function(){xx=!1,clearRect(context)}),window.onload=function(){drawRect(context)};